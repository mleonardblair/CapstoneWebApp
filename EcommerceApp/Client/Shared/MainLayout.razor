@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
<MudThemeProvider Theme="MyCustomTheme" />

<MudDialogProvider />
<MudSnackbarProvider />
<MudLayout>
    <MudAppBar Elevation="1" DisableGutters="true" Color="Color.Dark" Dense="false" Fixed="true">
        
        <!-- Hamburger menu icon for mobile view -->
        <MudHidden Breakpoint="Breakpoint.MdAndUp">
            <MudIconButton Icon="@Icons.Material.Filled.Menu" OnClick="@ToggleMenu" Class="my-custom-hover-button">
            </MudIconButton>
        </MudHidden>

         <div class="links">
            <MudHidden Breakpoint="Breakpoint.SmAndDown">
                <!-- Wrapper for centered items -->
                    <!-- Desktop links -->
                <MudButtonGroup Color="Color.Primary" Variant="Variant.Text">
                    <MudButton Color="Color.Inherit" OnClick="@ShopClicked" Class="nav-button">Shop</MudButton>
                    <MudButton Color="Color.Inherit" OnClick="@GalleryClicked" Class="nav-button">Gallery</MudButton>
                    <MudButton Color="Color.Inherit" OnClick="@FAQClicked" Class="nav-button">FAQ</MudButton>
                    <MudButton Color="Color.Inherit" OnClick="@AboutUsClicked" Class="nav-button">About Us</MudButton>
                    <MudButton Color="Color.Inherit" OnClick="@ContactUsClicked" Class="nav-button">Contact Us</MudButton>
                </MudButtonGroup>
            </MudHidden>
            </div>

        <div class="icons">
            <Search/>
            <MudIconButton Class="my-custom-hover-button" Icon="@Icons.Material.Filled.Person" Color="Color.Inherit" OnClick="@ProfileClicked" Style="transition: color 0.3s;" />
            <CartCounter></CartCounter>

        </div>

    </MudAppBar>
    @if (MenuOpen)
    {
        <div class="menu-dropdown">
            <MudList>
                 <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home" Href="/" Class="full-width-link">Home</MudNavLink>
                <MudNavLink  Class="menu-nav-link" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Store" OnClick="@ShopClicked">Shop</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Image" OnClick="@GalleryClicked">Gallery</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.AllInclusive"
                            OnClick="@AboutUsClicked">About Us</MudNavLink>    
                <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.QuestionMark" OnClick="@FAQClicked">FAQ</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.AlternateEmail" OnClick="@ContactUsClicked">Contact Us</MudNavLink>
            </MudList>
        </div>
    }
  
    <MudMainContent Style="padding-top: 0">
        <MudContainer Class="@containerClass">

            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>
@code {
    private bool MenuOpen = false;
    private string containerClass = "";
    private string _mainContentClass;
    private string MainContentClass
    {
        get => _mainContentClass;
        set
        {
            if (_mainContentClass != value)
            {
                _mainContentClass = value;
                StateHasChanged();
            }
        }
    }

    private void ToggleMenu()
    {
        MenuOpen = !MenuOpen;
        MainContentClass = MenuOpen ? "main-content-push-down" : "";
    }
    protected override void OnInitialized()
    {
        // Ensuring the main content has enough padding to not be hidden under the AppBar.
        MainContentClass = "pt-5"; // assuming 5 is enough padding to clear the AppBar
        var uri = new Uri(NavigationManager.Uri);
        if (uri.LocalPath == "/gallery")
        {
            Console.WriteLine("Special Padding Set");
            containerClass = "home-container-padding";
        }
    }
    private void HomeClicked() => NavigationManager.NavigateTo("/");
    private void ShopClicked() => NavigationManager.NavigateTo("/shop");
    private void GalleryClicked() => NavigationManager.NavigateTo("/gallery");
    private void FAQClicked() => NavigationManager.NavigateTo("/faq");
    private void AboutUsClicked() => NavigationManager.NavigateTo("/aboutus");
    private void ContactUsClicked() => NavigationManager.NavigateTo(RouteConstants.ShopCreateProduct);
    private void ProfileClicked() => NavigationManager.NavigateTo("/profile");
    private void CartClicked() => NavigationManager.NavigateTo("/cart");

    MudTheme MyCustomTheme = new MudTheme()
        {
            Typography = new Typography()
            {
                Default = new Default()
                {

                    FontFamily = new[] { "Roboto", "sans-serif" }
                }
            },
            Palette = new PaletteLight()
            {
                Dark = Colors.Grey.Darken4,
                Warning = "#ff0000"//Colors.Red.Default
            },
            LayoutProperties = new LayoutProperties()
            {
                AppbarHeight = "64px",
                DrawerWidthLeft = "250px", // A more typical drawer width
            }
        };
}
