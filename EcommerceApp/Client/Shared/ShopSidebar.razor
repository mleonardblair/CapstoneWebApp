@inject ICategoryService CategoryService // Inject the CategoryService;
@inject ITagService TagService;

<MudPaper Class="mx-2" Elevation="0">
    @if (CategoryService.Categories == null)
    {
    <MudPaper Square="true" 
        Elevation="3">
            <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="20px" Class="my-md-3 my-lg-3 my-xl-4" />
            <MudSkeleton Height="2px" Class="my-md-3 my-lg-3 my-xl-4" />
            <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
            <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
            <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        </MudPaper>
    }
    else
    {
        <MudPaper 
            Class="py-md-6 py-lg-6 py-xl-6 mr-md-2 mr-sm-3  mr-lg-2 mr-xl-2 mb-2" 
            Elevation="0"
            Style="position: relative;">
            <MudNavMenu Rounded="true" Margin="Margin.Normal">
                <MudText Typo="Typo.h6" Color="Color.Primary" Class="p-4">Categories</MudText>
                @*<MudText Typo="Typo.body2" Class="px-4 mud-text-secondary">Style based categories</MudText>*@
                <MudDivider Class="my-2" />
                @foreach (var category in CategoryService.Categories)
                {
                    <MudNavLink Href="@($"shop/category/{category.Id}")">@category.Name</MudNavLink>
                }
            </MudNavMenu>
        </MudPaper>
    }
   



@if (TagService.Tags == null || TagService.Tags.Count == 0)
{
    <MudPaper Square="true"
          Elevation="3">
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="20px" Class="my-md-3 my-lg-3 my-xl-4" />
        <MudSkeleton Height="2px" Class="my-md-3 my-lg-3 my-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
          <MudSkeleton Height="2px" Class="my-md-3 my-lg-3 my-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
          <MudSkeleton Height="2px" Class="my-md-3 my-lg-3 my-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="2px" Class="my-md-3 my-lg-3 my-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
        <MudSkeleton Height="42px;" Class="py-md-3 py-lg-3 py-xl-4" />
    </MudPaper>

}
else
{
        <MudDivider Class="my-2" />
     <MudPaper 
            Class="py-md-12 py-lg-12 py-xl-12 mr-md-2 mr-sm-3  mr-lg-2 mr-xl-2" 
            Elevation="0"
            Style="position: relative;">
            <MudText Typo="Typo.h6" Color="Color.Primary" Class="p-4">Tags</MudText>
            <MudDivider Class="my-2" />
        <MudChipSet Class="justify-content-center">

            @foreach (var tag in TagService.Tags)
            {
                @if (!TagColors.ContainsKey(tag.Name))
                {
                    TagColors[tag.Name] = MudMethods.GetRandomColor2(TagColors);
                }
                <MudChip Variant="Variant.Text"
                     Class="my-2 py-5"
                    Text="@tag.Name"
                    Href="@($"shop/tag/{tag.Id}")"
                    Color="@TagColors[tag.Name]"
                    @key="tag.Id">
                </MudChip>
            }
        </MudChipSet>
    </MudPaper>
}
</MudPaper>
@code {
    private Dictionary<string, MudBlazor.Color> TagColors = new Dictionary<string, MudBlazor.Color>();
    protected override async Task OnInitializedAsync()
    {
      await CategoryService.GetAllCategoriesAsync();
      await TagService.GetAllTagsAsync();
    }
}
